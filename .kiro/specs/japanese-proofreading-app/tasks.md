# 実装計画

- [ ] 1. プロジェクト構造とコアインターフェースのセットアップ
  - Next.js 14プロジェクトの初期化とディレクトリ構造作成
  - TypeScriptとTailwind CSSの設定
  - コアデータモデル（Issue、Suggestion、Rule）のTypeScriptインターフェース定義
  - _要件: 1, 7_

- [ ] 2. ルールエンジンとYAMLパーサーの実装
  - [ ] 2.1 YAMLルールファイルパーサーの作成
    - YAMLファイル読み込みとRule型への変換機能を実装
    - ルールファイル検証とエラーハンドリングを追加
    - _要件: 5.6_

  - [ ] 2.2 基本ルールエンジンの実装
    - 正規表現ベースのルールマッチング機能を作成
    - テキスト範囲検出とIssue生成ロジックを実装
    - _要件: 2.1, 2.2, 2.3_

  - [ ] 2.3 日本語特有ルールの実装
    - 表記ゆれ検出ルール（コンピュータ/コンピューター等）を実装
    - ら抜き言葉検出ルールを実装
    - 冗長表現検出ルール（することができる→できる等）を実装
    - 敬語誤用検出ルール（二重敬語等）を実装
    - _要件: 2.1, 2.2, 2.3, 2.4_

- [ ] 3. APIルートの実装
  - [ ] 3.1 /api/lintエンドポイントの作成
    - LintRequest/LintResponseインターフェースに基づくAPI実装
    - ルールエンジンとの統合とエラーハンドリング
    - パフォーマンス測定とメタデータ返却機能
    - _要件: 1.3, 2.8_

  - [ ] 3.2 /api/rulesエンドポイントの作成
    - ルールセット一覧取得とルール管理API実装
    - ルールの有効/無効切り替え機能
    - ルールセットのホットリロード機能
    - _要件: 5.1, 5.2, 5.3, 5.4_

  - [ ] 3.3 /api/settingsエンドポイントの作成
    - AppSettings型に基づく設定保存/読み込みAPI実装
    - LocalStorageとの連携機能
    - 設定検証とデフォルト値処理
    - _要件: 8.1, 8.2, 8.3, 8.6_

- [ ] 4. LLMクライアントと/api/suggestの実装
  - [ ] 4.1 Gemini APIクライアントの作成
    - ローカルGemini 2.5 Flash APIへのHTTPクライアント実装
    - 接続エラーハンドリングとタイムアウト処理
    - _要件: 6.1, 6.4_

  - [ ] 4.2 /api/suggestエンドポイントの実装
    - SuggestRequest/SuggestResponseインターフェースに基づくAPI実装
    - テキスト抜粋送信とLLM応答処理
    - 断定的でない表現での提案生成
    - _要件: 3.1, 3.2, 3.3, 3.4, 3.5_

- [ ] 5. 状態管理とZustandストアの実装
  - アプリケーション状態（テキスト、問題、設定）のZustandストア作成
  - 問題選択、フィルタリング、設定変更のアクション実装
  - ローカルストレージとの同期機能
  - _要件: 4.1, 4.2, 4.3, 8.6_

- [ ] 6. コアUIコンポーネントの実装
  - [ ] 6.1 AppLayoutとHeaderコンポーネント
    - Dialin AIスタイルのカードベースレイアウト実装
    - ヘッダーに解析ボタンと設定アクセスを配置
    - キーボードショートカット（Ctrl+Enter）の実装
    - _要件: 7.1, 7.2, 7.5_

  - [ ] 6.2 TextEditorコンポーネント
    - 等幅フォント、行番号付きテキストエリアの実装
    - 問題ハイライト（下線）表示機能
    - テキスト選択と問題選択の連携
    - _要件: 1.4, 7.3_

  - [ ] 6.3 IssueHighlightコンポーネント
    - テキスト内の問題箇所ハイライト表示
    - 重要度別の視覚的フィードバック（色+アイコン）
    - クリックによる問題選択機能
    - _要件: 4.3, 7.4_

- [ ] 7. 問題管理UIの実装
  - [ ] 7.1 IssueListコンポーネント
    - 問題の種別・重要度・カテゴリ別表示
    - フィルタリングとソート機能
    - 仮想スクロール（100項目以上）の実装
    - _要件: 4.1, 4.6_

  - [ ] 7.2 IssueDetailコンポーネント
    - 選択された問題の詳細情報表示
    - 修正提案（最大3案）と理由の表示
    - 個別適用ボタンの実装
    - _要件: 4.2, 3.2_

  - [ ] 7.3 IssueFiltersコンポーネント
    - 問題タイプ、重要度、カテゴリのフィルター実装
    - 問題数統計の表示
    - 全フィルタクリア機能
    - _要件: 4.6_

- [ ] 8. 修正適用機能の実装
  - [ ] 8.1 個別修正適用機能
    - 選択された提案をテキストに即座反映
    - テキスト範囲の正確な置換処理
    - 適用後の問題リスト更新
    - _要件: 4.4_

  - [ ] 8.2 安全な一括修正機能
    - autoFix=trueの問題のみを一括適用
    - 意味変化リスクゼロの安全置換のみ処理
    - 適用結果のフィードバック表示
    - _要件: 4.5_

- [ ] 9. 設定画面の実装
  - [ ] 9.1 SettingsModalコンポーネント
    - タブ付きインターフェースの設定画面作成
    - 一般設定（解析トリガー、文長制限）の実装
    - フォーム検証とエラーハンドリング
    - _要件: 8.1, 8.2_

  - [ ] 9.2 ルール設定タブ
    - ルールセット選択UI
    - 個別ルールの有効/無効切り替え
    - ルール重要度変更スライダー
    - _要件: 5.1, 5.2, 5.3_

  - [ ] 9.3 LLM設定タブ
    - Gemini APIのベースURL・APIキー設定
    - LLM提案の有効/無効切り替え
    - プライバシートグル（外部送信防止）
    - _要件: 6.2, 8.3, 8.5_

- [ ] 10. アクセシビリティ機能の実装
  - [ ] 10.1 キーボードナビゲーション
    - 全コンポーネントでのTab/Enter/Space/Escサポート
    - フォーカス管理とフォーカスインジケーター
    - キーボードショートカットの実装
    - _要件: 7.5, 10.1_

  - [ ] 10.2 スクリーンリーダー対応
    - 問題リストのaria-label設定
    - 重要度の色+アイコン+ラベル表示
    - 読み上げ可能な問題説明の実装
    - _要件: 7.4, 10.2, 10.3_

- [ ] 11. パフォーマンス最適化
  - [ ] 11.1 フロントエンド最適化
    - 大きな問題リストでの仮想スクロール実装
    - 入力中のデバウンス解析（500ms）
    - 高コストレンダリング操作のメモ化
    - _要件: 1.5_

  - [ ] 11.2 バックエンド最適化
    - ルールエンジンでのコンパイル済み正規表現キャッシュ
    - 2000文字P95<5秒の性能要件達成
    - メモリ使用量の最適化
    - _要件: 1.3, 9.1, 9.2_

- [ ] 12. エラーハンドリングとフォールバック
  - 文字数制限超過時の警告バナー実装
  - LLMタイムアウト時のエラー表示（ルール結果は維持）
  - ルール読み込み失敗時のデフォルトルールフォールバック
  - _要件: 1.2, 6.4, 5.6_

- [ ] 13. デフォルトルールセットの作成
  - 日本語標準ルールセット（YAML）の作成
  - 表記ゆれ、文法、敬語、スタイルの各カテゴリルール定義
  - ルールメッセージの日本語化
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

- [ ] 14. 統合テストとE2Eテスト
  - 完全な校正ワークフローのテスト実装
  - API統合テストの作成
  - アクセシビリティテスト（キーボード操作、スクリーンリーダー）
  - _要件: 2.8, 4.7, 10.1, 10.2_